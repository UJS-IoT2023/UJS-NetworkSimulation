## TCP vs UDP 协议性能对比研究

### 实验概述

本实验使用 ns-3 网络模拟器，在不同网络条件下对比 TCP 和 UDP 协议的性能特性。研究评估了两种协议的吞吐量、延迟、丢包率和公平性。

### 实验设置

#### 网络拓扑
- **节点**: 2个节点（节点0作为客户端，节点1作为服务器）
- **链路**: 点对点连接
- **协议**: TCP 和 UDP 同时运行
- **测量**: 使用 FlowMonitor 收集性能指标

#### 测试场景

1. **理想网络条件**
   - 数据率: 10Mbps
   - 延迟: 2ms
   - 错误率: 0%
   - TCP算法: NewReno

2. **高延迟网络**
   - 数据率: 10Mbps
   - 延迟: 50ms
   - 错误率: 0%
   - TCP算法: NewReno

3. **有丢包网络**
   - 数据率: 10Mbps
   - 延迟: 2ms
   - 错误率: 1%
   - TCP算法: NewReno

4. **低带宽网络**
   - 数据率: 1Mbps
   - 延迟: 2ms
   - 错误率: 0%
   - TCP算法: NewReno

5. **TCP算法对比**
   - 数据率: 10Mbps
   - 延迟: 2ms
   - 错误率: 0%
   - 算法: NewReno、Cubic、Vegas

6. **混合网络条件**
   - 数据率: 5Mbps
   - 延迟: 20ms
   - 错误率: 0.5%
   - TCP算法: NewReno

### 性能指标

- **吞吐量**: 数据传输速率（Mbps）
- **平均延迟**: 端到端延迟（毫秒）
- **丢包率**: 丢失数据包的百分比
- **公平性指数**: 协议间的资源分配公平性

### 实现细节

#### 核心仿真脚本 (`lab3_tcp_udp_comparison.cc`)

主要仿真脚本实现了：
- 双协议客户端-服务器架构
- 同时运行的 TCP 和 UDP 流量生成
- 网络条件变化
- 性能测量收集
- 公平性分析

#### 自动化脚本 (`lab3_tcp_udp_automation.py`)

自动化框架提供：
- 自动化测试执行
- 多场景测试
- 数据收集和解析
- 性能可视化
- 综合报告生成

### 实验结果

#### 协议特性

**TCP协议:**
- 面向连接，可靠数据传输
- 拥塞控制机制
- 流量控制用于速率适应
- 丢失数据包重传

**UDP协议:**
- 无连接，不可靠数据传输
- 无拥塞控制
- 较低的开销和延迟
- 适合实时应用

#### 性能分析

**吞吐量对比:**
- TCP在拥塞条件下表现出自适应行为
- UDP在理想条件下保持一致的吞吐量
- TCP在丢包网络中的吞吐量显著下降

**延迟特性:**
- UDP通常具有较低的延迟
- TCP延迟随拥塞和重传增加
- 高延迟网络对两种协议影响相似

**丢包行为:**
- TCP由于重传机制，有效丢包率较低
- UDP显示实际丢包率
- TCP的拥塞控制在拥塞网络中减少丢包

**公平性分析:**
- 公平性指数衡量资源分配的公平性
- 值接近1.0表示更好的公平性
- TCP的拥塞控制在共享网络中提供更好的公平性

### TCP拥塞控制算法

#### NewReno
- TCP Reno的增强版本
- 更好地从多个数据包丢失中恢复
- 在丢包网络中性能更好

#### Cubic
- Linux系统中的默认算法
- 在高带宽网络中具有更好的可扩展性
- 更积极的窗口增长

#### Vegas
- 基于延迟的拥塞控制
- 主动的拥塞避免
- 更好的公平性但吞吐量较低

### 主要发现

1. **网络条件影响**
   - TCP在拥塞网络中表现更好
   - UDP在低延迟要求下表现优异
   - 两种协议在网络严重退化时都会受到影响

2. **协议公平性**
   - TCP在资源共享中表现出更好的公平性
   - UDP在无监管环境中可能主导带宽
   - TCP的拥塞控制提高了公平性

3. **应用适用性**
   - TCP：文件传输、网页浏览、可靠通信
   - UDP：实时流媒体、游戏、VoIP应用

4. **算法选择**
   - NewReno：通用目的，可靠性能
   - Cubic：高带宽、长距离网络
   - Vegas：低延迟、注重公平性的应用

### 技术实现

#### 代码结构

```
scratch/exp3/
├── lab3_tcp_udp_comparison.cc    # 主要仿真脚本
├── lab3_tcp_udp_automation.py    # 自动化框架
└── CMakeLists.txt                # 构建配置
```

#### 测量方法

1. **FlowMonitor集成**
   - 收集每个流的统计信息
   - 测量吞吐量、延迟、丢包
   - 提供全面的性能数据

2. **公平性计算**
   - 使用Jain公平性指数公式
   - 评估协议资源分配
   - 范围：0.0（不公平）到1.0（完全公平）

3. **自动化测试**
   - 参数化测试执行
   - 批量处理场景
   - 自动化数据收集和分析

### 结论

这项综合研究展示了TCP和UDP协议在各种网络条件下的基本差异。结果突出了：

- TCP的可靠性和拥塞控制优势
- UDP的低延迟和简单性优势
- 基于应用需求选择协议的重要性
- 不同TCP拥塞控制算法的有效性

实验框架为进一步的网络协议研究和性能分析提供了坚实的基础。

### 生成的文件

- `results_tcp_udp/tcp_udp_comparison_*.png` - 性能对比图表
- `results_tcp_udp/tcp_udp_results_*.json` - 详细测试数据（JSON格式）
- `results_tcp_udp/tcp_udp_results_*.csv` - 测试数据（CSV格式）
- `results_tcp_udp/tcp_udp_analysis_*.txt` - 详细分析报告

### 未来工作

本研究的潜在扩展包括：
- 使用更复杂的网络拓扑进行测试
- 评估其他TCP变体（BBR、DCTCP）
- 研究无线网络中的协议行为
- 分析不同应用模式下的性能
- 研究缓冲区大小和队列管理的影响
